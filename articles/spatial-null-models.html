<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SESraster">
<title>Spatial null model algorithms in SESraster • SESraster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial null model algorithms in SESraster">
<meta property="og:description" content="SESraster">
<meta property="og:image" content="https://hemingnm.github.io/SESraster/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SESraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/null-models.html">Null model algorithms</a>
    <a class="dropdown-item" href="../articles/spatial-null-models.html">Spatial null model algorithms in SESraster</a>
    <a class="dropdown-item" href="../articles/SES.html">Standardized effect sizes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/HemingNM/SESraster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spatial null model algorithms in SESraster</h1>
                        <h4 data-toc-skip class="author">Neander M.
Heming, Flávio Mota, and Gabriela Alves-Ferreira</h4>
            
            <h4 data-toc-skip class="date">2023-07-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HemingNM/SESraster/blob/HEAD/vignettes/spatial-null-models.Rmd" class="external-link"><code>vignettes/spatial-null-models.Rmd</code></a></small>
      <div class="d-none name"><code>spatial-null-models.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="contents">Contents<a class="anchor" aria-label="anchor" href="#contents"></a>
</h2>
<ul>
<li><a href="#install">Installation</a></li>
<li>
<a href="#analysis">Analysis</a>
<ul>
<li><a href="#randsp">Random species generation</a></li>
<li>
<a href="#spat-unstr">Spatially Unstructured Randomization</a>
<ul>
<li><a href="#ee">Equiprobable-Equiprobable</a></li>
<li><a href="#fe">Fixed-Equiprobable</a></li>
<li><a href="#ef">Equiprobable-Fixed</a></li>
</ul>
</li>
<li>
<a href="#spat-str">Spatially Structured Randomization</a>
<ul>
<li><a href="#fp">Fixed-Proportional</a></li>
<li><a href="#ff">Fixed-Fixed</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<p><br></p>
<p>After an overview of the null model algorithms forspecies
co-occurrence analysis in <code><a href="../articles/null-models.html">vignette("null-models")</a></code>, let’s
see how the randomization algorithms implemented in
<code>SESraster</code> behave for spatial data.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="install">Installation<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<p>Install from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"SESraster"</span><span class="op">)</span></span></code></pre></div>
<p>The development version of <code>SESraster</code> can be installed
from the <a href="https://github.com/HemingNM/SESraster" class="external-link">SESraster</a>
repository in Github:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"HemingNM/SESraster"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>The <code>SESraster</code> package implements functions to randomize
presence/absence species distribution raster data with or without
including spatial structure for calculating Standardized Effect Sizes
(SES) necessary for null hypothesis testing. The function
<code><a href="../reference/bootspat_naive.html">bootspat_naive()</a></code> does not retain the spatial structure of
community richness and species distribution size at the same time. It
randomizes a raster stack according to the observed frequency of
presences for each species (layer) using any of the following methods:
sites (raster cells), species (raster layers) or both (layers and
cells). This, randomization without retaining spatial structure of data,
is the most commonly used method of randomization for community data.
The function <code><a href="../reference/bootspat_str.html">bootspat_str()</a></code> does retain the spatial
structure of community richness and species distribution size at the
same time. It randomizes a raster stack keeping the species richness
fixed across raster cells. To our knowledge this method was not
previously implemented in <code>R</code>.</p>
<p>Let’s see some examples.</p>
<p><br></p>
<div class="section level3">
<h3 id="randsp">Random species generation<a class="anchor" aria-label="anchor" href="#randsp"></a>
</h3>
<p>Now, let’s see some of the package features. First, we will create
some random species distributions using the package
<code>terra</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=SESraster" class="external-link">SESraster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is SESraster 0.7.0</span></span>
<span><span class="co">#&gt; If you use SESraster, please cite in your publications. See:</span></span>
<span><span class="co">#&gt;   citation("SESraster")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.39</span></span>
<span><span class="co"># creating random species distributions</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/elev.tif"</span>, package<span class="op">=</span><span class="st">"terra"</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">510</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span>,</span>
<span>                <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">r</span>, <span class="va">mn</span>, <span class="va">mx</span><span class="op">)</span><span class="op">{</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">r</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">t</span><span class="op">)</span><span class="op">{</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">t</span><span class="op">)</span><span class="op">{</span></span>
<span>                       <span class="va">x</span><span class="op">&lt;</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">&gt;</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>                    <span class="op">}</span>, t<span class="op">=</span><span class="va">t</span><span class="op">)</span></span>
<span>                  <span class="op">}</span>, t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">mn</span>, <span class="va">mx</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="op">}</span>, r<span class="op">=</span><span class="va">r</span>, mn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">10</span>, mx<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/rand-spp-1.png" width="576"></p>
<p><br></p>
<p>With the distributions in hand, we can perform the spatial
randomizations.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="spat-unstr">Spatially Unstructured Randomization<a class="anchor" aria-label="anchor" href="#spat-unstr"></a>
</h3>
<p>First, let’s randomize species distribution ignoring the spatial
structure with the function <code>bootspat_naive</code>.</p>
<div class="section level4">
<h4 id="ee">Equiprobable-Equiprobable: by site and species simultaneously<a class="anchor" aria-label="anchor" href="#ee"></a>
</h4>
<p>We can randomize the presences/absences (1s/0s) using the method
<code>both</code>. This method combines randomization by site and
species at the same time. It will shuffle all presences across cells and
layers, changing site richness and species distribution sizes and
location at the same time. It is equivalent to the SIM1
(equiprobable-equiprobable) method of Gotelli <span class="citation">(<a href="#ref-gotelli2000" role="doc-biblioref">2000</a>)</span>. Notice
that NA cells are ignored.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">srb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootspat_naive.html">bootspat_naive</a></span><span class="op">(</span><span class="va">r</span>, random <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srb</span>, legend<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/naive-both-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">srb</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"randomized"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/naive-both-rich-1.png" width="576"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="fe">Fixed-Equiprobable: by species<a class="anchor" aria-label="anchor" href="#fe"></a>
</h4>
<p>We can randomize by <code>species</code>. This second method is
performed at each layer (species) of the stack by randomizing the
position of species presences in space. If the data fits to the computer
RAM memory this randomization is equivalent to the SIM2
(fixed-equiprobable) method of Gotelli <span class="citation">(<a href="#ref-gotelli2000" role="doc-biblioref">2000</a>)</span> and to the
flatland model of Laffan &amp; Crisp <span class="citation">(<a href="#ref-laffan2003" role="doc-biblioref">2003</a>)</span>. It changes
the species richness at each cell while retaining the size of the
species distribution (except if randomization is performed by
frequency). When running by frequency, presences/absences (1s/0s) are
sampled at each pixel based on the probability (frequency) that the
species is found within the study area. It is equivalent to the SIM7
(proportional-equiprobable) method of Gotelli <span class="citation">(<a href="#ref-gotelli2000" role="doc-biblioref">2000</a>)</span>. For each
species, the randomized frequency of presences is very similar to the
actual frequency but not exactly the same.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootspat_naive.html">bootspat_naive</a></span><span class="op">(</span><span class="va">r</span>, random <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sr1</span>, legend<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/naive-spp-1.png" width="576"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sr1</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"randomized"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/naive-spp-rich-1.png" width="576"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootspat_naive.html">bootspat_naive</a></span><span class="op">(</span><span class="va">r</span>, random <span class="op">=</span> <span class="st">"species"</span>, memory <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The file does not fit on the memory. Randomization will be done by probability.</span></span></code></pre></div>
<p>Check that the number of occupied pixels of randomized distributions
are similar to those of the observed distributions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>observed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">r</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      randomized<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sr1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      randomized_freq<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sr1b</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       observed randomized randomized_freq</span></span>
<span><span class="co">#&gt;  [1,]      767        767             773</span></span>
<span><span class="co">#&gt;  [2,]     3443       3443            3452</span></span>
<span><span class="co">#&gt;  [3,]     1175       1175            1180</span></span>
<span><span class="co">#&gt;  [4,]      889        889             872</span></span>
<span><span class="co">#&gt;  [5,]      908        908             952</span></span>
<span><span class="co">#&gt;  [6,]     2160       2160            2143</span></span>
<span><span class="co">#&gt;  [7,]      548        548             544</span></span>
<span><span class="co">#&gt;  [8,]      133        133             127</span></span>
<span><span class="co">#&gt;  [9,]      122        122             118</span></span>
<span><span class="co">#&gt; [10,]     4174       4174            4171</span></span>
<span><span class="co">#&gt; [11,]     2565       2565            2502</span></span>
<span><span class="co">#&gt; [12,]     3031       3031            3029</span></span>
<span><span class="co">#&gt; [13,]       36         36              35</span></span>
<span><span class="co">#&gt; [14,]     4387       4387            4398</span></span>
<span><span class="co">#&gt; [15,]     3270       3270            3235</span></span>
<span><span class="co">#&gt; [16,]     2198       2198            2216</span></span>
<span><span class="co">#&gt; [17,]     2427       2427            2392</span></span>
<span><span class="co">#&gt; [18,]      235        235             229</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="ef">Equiprobable-Fixed: by site<a class="anchor" aria-label="anchor" href="#ef"></a>
</h4>
<p>Now, we will randomize by <code>site</code>. This method randomizes
the position (presence/absence) of the species within each site (cell)
of the stack. This method keeps species richness constant at each cell
but the size of the species distribution might change, as more or less
pixels can be randomly assigned to each species (raster layer). This
randomization is equivalent to the SIM3 (equiprobable-fixed) method of
Gotelli <span class="citation">(<a href="#ref-gotelli2000" role="doc-biblioref">2000</a>)</span>. Notice that, although the spatial
structure of species richness is held constant, the number of pixels
that each species occupy is completely randomized.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootspat_naive.html">bootspat_naive</a></span><span class="op">(</span><span class="va">r</span>, random <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sr2</span>, legend<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/naive-site-1.png" width="576"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sr2</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"randomized"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/naive-site-rich-1.png" width="576"></p>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="spat-str">Spatially Structured Randomization<a class="anchor" aria-label="anchor" href="#spat-str"></a>
</h3>
<p>Notice that randomization by <code>site</code> from
<code><a href="../reference/bootspat_naive.html">bootspat_naive()</a></code> keeps the species richness fixed
(i.e. equal to the input raster), but the size of the species’
distribution (i.e. number of pixels of each species) is completely
randomized. On the other hand, randomization by <code>species</code>
keeps the number of pixels of each species fixed, but the richness is
completely randomized. The functions <code><a href="../reference/bootspat_str.html">bootspat_str()</a></code> and
<code><a href="../reference/bootspat_ff.html">bootspat_ff()</a></code> add some constraints to the randomization.
See below:</p>
<p><br></p>
<div class="section level4">
<h4 id="fp">Fixed-Proportional: function <code>bootspat_str()</code><a class="anchor" aria-label="anchor" href="#fp"></a>
</h4>
<p>In the function <code><a href="../reference/bootspat_str.html">bootspat_str()</a></code> we implement a spatially
structured randomization that keeps the species richness pattern fixed
and distribution size of each species, proportional. This method is
based on the second null model of Laffan &amp; Crisp <span class="citation">(<a href="#ref-laffan2003" role="doc-biblioref">2003</a>)</span>, but uses probability of sampling
presences based on frequency of presences for each species. Therefore,
it is equivalent to the SIM5 (proportional-fixed) method of Gotelli
<span class="citation">(<a href="#ref-gotelli2000" role="doc-biblioref">2000</a>)</span>. Notice that it will lack spatial
structure in the same way of randomization by <code>site</code>, however
the size of the species distribution is (nearly) retained.</p>
<p>Randomizations are based on frequencies (given or calculated from the
output raster (a presence-absence SpatRaster) and, optionally, a
probability raster stack. Both, the frequency vector and the probability
raster stack, control the probability that a given species is sampled in
each raster cell. The frequency vector controls the probability of
sampling each species compared to all others. The probability raster
stack controls the probability that each species is sampled on a given
raster cell.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bootstrapping once</span></span>
<span><span class="va">fr.prob</span> <span class="op">&lt;-</span> <span class="fu">SESraster</span><span class="fu">::</span><span class="fu"><a href="../reference/fr2prob.html">fr2prob</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">r</span>,</span>
<span>                   <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>                   <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">randr10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootspat_str.html">bootspat_str</a></span><span class="op">(</span><span class="va">r</span>, rprob <span class="op">=</span> <span class="va">prob</span>, fr_prob <span class="op">=</span> <span class="va">fr.prob</span><span class="op">)</span></span></code></pre></div>
<p>The species distribution was spatially randomized according to the
frequency of presence of each species. This method randomizes the
position of species presences in space keeping the species richness
constant and number of occupied pixels of randomized distributions very
similar those on the actual distributions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">randr10</span>, legend<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/str-site-1.png" width="576"></p>
<p>See unchanged spatial pattern of species richness.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">randr10</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"randomized"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/str-site-rich-1.png" width="576"></p>
<p>Check that the number of occupied pixels of randomized distributions
are very similar those of the observed distributions.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>observed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">r</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      randomized<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">randr10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       observed randomized</span></span>
<span><span class="co">#&gt;  [1,]      767        681</span></span>
<span><span class="co">#&gt;  [2,]     3443       3532</span></span>
<span><span class="co">#&gt;  [3,]     1175       1119</span></span>
<span><span class="co">#&gt;  [4,]      889        849</span></span>
<span><span class="co">#&gt;  [5,]      908        832</span></span>
<span><span class="co">#&gt;  [6,]     2160       2138</span></span>
<span><span class="co">#&gt;  [7,]      548        461</span></span>
<span><span class="co">#&gt;  [8,]      133        104</span></span>
<span><span class="co">#&gt;  [9,]      122         95</span></span>
<span><span class="co">#&gt; [10,]     4174       4246</span></span>
<span><span class="co">#&gt; [11,]     2565       2602</span></span>
<span><span class="co">#&gt; [12,]     3031       3127</span></span>
<span><span class="co">#&gt; [13,]       36         32</span></span>
<span><span class="co">#&gt; [14,]     4387       4413</span></span>
<span><span class="co">#&gt; [15,]     3270       3379</span></span>
<span><span class="co">#&gt; [16,]     2198       2193</span></span>
<span><span class="co">#&gt; [17,]     2427       2483</span></span>
<span><span class="co">#&gt; [18,]      235        182</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="fixed-fixed-function-bootspat_ff">Fixed-Fixed: function <code id="ff">bootspat_ff()</code><a class="anchor" aria-label="anchor" href="#fixed-fixed-function-bootspat_ff"></a>
</h4>
<p>In the function <code><a href="../reference/bootspat_ff.html">bootspat_ff()</a></code> we implement a spatially
structured randomization that keeps both, the species richness pattern
and species distribution size, fixed. This method is equivalent to the
SIM9 (fixed-fixed) method of Gotelli <span class="citation">(<a href="#ref-gotelli2000" role="doc-biblioref">2000</a>)</span> and is
based on the null model of Connor &amp; Simberloff <span class="citation">(<a href="#ref-connor1979" role="doc-biblioref">1979</a>)</span>, but has some differences.</p>
<p>The original algorithm randomly chooses the sequence of species and
fills sites (originally islands) until they reach the observed species
richness. However, as sites (cells) are filled with species, some
species do not have enough available sites to be placed, and their
sampled frequency is smaller than observed. Additionally, some sites
cannot be completely filled because duplicated species are not allowed
in the same site. Their solution was to increase the number of sites to
place the species. Here, we opted to order the sequence of species from
the largest Nj to the smallest. Our algorithm is usually able to match
the constraints (site richness and distribution size) but in some cases,
specially with small datasets, some sites lack on species to match the
original richness and some species are assigned to less sites than
originally observed.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bootstrapping once</span></span>
<span><span class="va">randff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootspat_ff.html">bootspat_ff</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p>See how species distribution sizes are maintained. Compare the
original and null distributions. Plots are sorted from the largest to
the smallest distributions.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs_fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/global.html" class="external-link">global</a></span><span class="op">(</span><span class="va">r</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">v_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">obs_fr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v_seq</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">randff</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v_seq</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, </span>
<span>     nr<span class="op">=</span><span class="fl">2</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"null"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v_seq</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/str-ff-1.png" width="576"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v_seq</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">:</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">randff</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v_seq</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span> <span class="fl">2</span><span class="op">:</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     nr<span class="op">=</span><span class="fl">2</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"null"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v_seq</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span> <span class="fl">2</span><span class="op">:</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/str-ff-2.png" width="576"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">randff</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, </span>
<span>     nr<span class="op">=</span><span class="fl">2</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"null"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="va">v_seq</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/str-ff-3.png" width="576"></p>
<p>See unchanged spatial pattern of species richness.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">randff</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">randff</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"randomized"</span>, <span class="st">"difference"</span><span class="op">)</span>, nr<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-null-models_files/figure-html/str-ff-rich-1.png" width="576"></p>
<p>Check that the number of occupied pixels of the randomized and the
observed distributions are the same.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>observed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">r</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      randomized<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">randff</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       observed randomized</span></span>
<span><span class="co">#&gt;  [1,]      767        767</span></span>
<span><span class="co">#&gt;  [2,]     3443       3443</span></span>
<span><span class="co">#&gt;  [3,]     1175       1175</span></span>
<span><span class="co">#&gt;  [4,]      889        889</span></span>
<span><span class="co">#&gt;  [5,]      908        908</span></span>
<span><span class="co">#&gt;  [6,]     2160       2160</span></span>
<span><span class="co">#&gt;  [7,]      548        548</span></span>
<span><span class="co">#&gt;  [8,]      133        133</span></span>
<span><span class="co">#&gt;  [9,]      122        122</span></span>
<span><span class="co">#&gt; [10,]     4174       4174</span></span>
<span><span class="co">#&gt; [11,]     2565       2565</span></span>
<span><span class="co">#&gt; [12,]     3031       3031</span></span>
<span><span class="co">#&gt; [13,]       36         36</span></span>
<span><span class="co">#&gt; [14,]     4387       4387</span></span>
<span><span class="co">#&gt; [15,]     3270       3270</span></span>
<span><span class="co">#&gt; [16,]     2198       2198</span></span>
<span><span class="co">#&gt; [17,]     2427       2427</span></span>
<span><span class="co">#&gt; [18,]      235        235</span></span></code></pre></div>
<p><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="standardized-effect-sizes">Standardized effect sizes<a class="anchor" aria-label="anchor" href="#standardized-effect-sizes"></a>
</h2>
<p>Time to compute standardized effect sizes (SES) using the implemented
null model algorithms: <code><a href="../articles/SES.html">vignette("SES")</a></code>.</p>
<p><br></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-connor1979" class="csl-entry">
Connor, Edward F., and Daniel Simberloff. 1979. <span>“The Assembly of
Species Communities: Chance or Competition?”</span> <em>Ecology</em> 60
(6): 1132–40. <a href="https://doi.org/10.2307/1936961" class="external-link">https://doi.org/10.2307/1936961</a>.
</div>
<div id="ref-gotelli2000" class="csl-entry">
Gotelli, Nicholas J. 2000. <span>“Null Model Analysis of Species
Co-Occurrence Patterns.”</span> <em>Ecology</em> 81 (9): 2606–21. <a href="https://doi.org/10.2307/177478" class="external-link">https://doi.org/10.2307/177478</a>.
</div>
<div id="ref-laffan2003" class="csl-entry">
Laffan, Shawn W., and Michael D. Crisp. 2003. <span>“Assessing Endemism
at Multiple Spatial Scales, with an Example from the Australian Vascular
Flora.”</span> <em>Journal of Biogeography</em> 30 (4): 511–20. <a href="https://doi.org/10.1046/j.1365-2699.2003.00875.x" class="external-link">https://doi.org/10.1046/j.1365-2699.2003.00875.x</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Neander Marcel Heming, Flávio M. M. Mota, Gabriela Alves-Ferreira.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
