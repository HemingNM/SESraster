<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SESraster">
<title>Standardized effect sizes • SESraster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Standardized effect sizes">
<meta property="og:description" content="SESraster">
<meta property="og:image" content="https://hemingnm.github.io/SESraster/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SESraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/null-models.html">Null model algorithms</a>
    <a class="dropdown-item" href="../articles/spatial-null-models.html">Spatial null model algorithms in SESraster</a>
    <a class="dropdown-item" href="../articles/SES.html">Standardized effect sizes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/HemingNM/SESraster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Standardized effect sizes</h1>
                        <h4 data-toc-skip class="author">Neander M.
Heming, Flávio Mota, and Gabriela Alves-Ferreira</h4>
            
            <h4 data-toc-skip class="date">2023-08-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HemingNM/SESraster/blob/HEAD/vignettes/SES.Rmd" class="external-link"><code>vignettes/SES.Rmd</code></a></small>
      <div class="d-none name"><code>SES.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="contents">Contents<a class="anchor" aria-label="anchor" href="#contents"></a>
</h2>
<ul>
<li><a href="#ses">Standardized effect sizes</a></li>
<li>
<a href="#analysis">Calculating SES</a>
<ul>
<li><a href="#randsp">Random species generation</a></li>
<li><a href="#ses-spat">SES with spatial randomization</a></li>
<li><a href="#ses-trait">SES from species trait randomization</a></li>
</ul>
</li>
<li><a href="#concl">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<p><br></p>
<p>After understanding how the spatial null model algorithms work
(<code><a href="../articles/spatial-null-models.html">vignette("spatial-null-models")</a></code>), let’s see how to create
multiple null models and test for the effect size using
<code><a href="../reference/SESraster.html">SESraster()</a></code>.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="ses">Standardized effect size<a class="anchor" aria-label="anchor" href="#ses"></a>
</h2>
<p>Standardized effect size (SES) is a measure of the magnitude of the
studied effect. It indicates the direction and the degree that the
effect departures from the null model. SESraster uses Cohen’s <em>d</em>
<span class="citation">(<a href="#ref-cohen1988" role="doc-biblioref">Cohen 1988</a>)</span>, which is measured as the
difference between the observed pattern and the average of <em>n</em>
randomized observations divided by the standard deviation of the
randomized observations <span class="math inline">\(SES =
(Obs-mean(Null))/sd(Null)\)</span>.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="analysis">Calculating SES<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<div class="section level3">
<h3 id="randsp">Random species generation<a class="anchor" aria-label="anchor" href="#randsp"></a>
</h3>
<p>First, we will create some random species distributions using the
package <code>terra</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=SESraster" class="external-link">SESraster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is SESraster 0.7.0</span></span>
<span><span class="co">#&gt; If you use SESraster, please cite in your publications. See:</span></span>
<span><span class="co">#&gt;   citation("SESraster")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.39</span></span>
<span><span class="co"># creating random species distributions</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/elev.tif"</span>, package<span class="op">=</span><span class="st">"terra"</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">510</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span>,</span>
<span>                <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">r</span>, <span class="va">mn</span>, <span class="va">mx</span><span class="op">)</span><span class="op">{</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">r</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">t</span><span class="op">)</span><span class="op">{</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">t</span><span class="op">)</span><span class="op">{</span></span>
<span>                       <span class="va">x</span><span class="op">&lt;</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">&gt;</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>                    <span class="op">}</span>, t <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span>                  <span class="op">}</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">mn</span>, <span class="va">mx</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="op">}</span>, r <span class="op">=</span> <span class="va">r</span>, mn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">10</span>, mx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="SES_files/figure-html/rand-spp-1.png" width="384"></p>
<p><br></p>
<p>With the distributions in hand, we can perform the spatial
randomizations.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="ses-spat">SES with spatial randomization<a class="anchor" aria-label="anchor" href="#ses-spat"></a>
</h3>
<p>First we need a function that computes the desired metric. The
function must work with spatial data. Just to exemplify, we are creating
a function to compute the mean of presences and absences (1/0) within
each cell. You probably wants to use a more ecologically meaningful
function, but here is just an example of use.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">appmean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>                      <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"mean"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><br></p>
<p>Now, to compute SES, we will compute our desired metric by sending
our function <code>appmean()</code> to <code><a href="../reference/SESraster.html">SESraster()</a></code> through
<code>FUN</code> argument. We also randomize the original data by
<code>species</code> using the <code><a href="../reference/bootspat_naive.html">bootspat_naive()</a></code> algorithm
and passing the argument <code>random="species"</code> through
<code>spat_alg_args</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ses.sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SESraster.html">SESraster</a></span><span class="op">(</span><span class="va">r</span>, FUN <span class="op">=</span> <span class="va">appmean</span>, </span>
<span>                    spat_alg <span class="op">=</span> <span class="st">"bootspat_naive"</span>, spat_alg_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>random <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span>,</span>
<span>                    aleats <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ses.sp</span><span class="op">)</span></span></code></pre></div>
<p><img src="SES_files/figure-html/ses-spat-sp-1.png" width="384"></p>
<p><br></p>
<p>Compute metric and SES using <code><a href="../reference/bootspat_naive.html">bootspat_naive()</a></code> and
randomize by <code>site</code> changing the argument to
<code>random="site"</code> in <code>spat_alg_args</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ses.st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SESraster.html">SESraster</a></span><span class="op">(</span><span class="va">r</span>, FUN <span class="op">=</span> <span class="va">appmean</span>,</span>
<span>                    spat_alg <span class="op">=</span> <span class="st">"bootspat_naive"</span>, spat_alg_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>random <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span>,</span>
<span>                    aleats <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ses.st</span><span class="op">)</span></span></code></pre></div>
<p><img src="SES_files/figure-html/ses-spat-st-1.png" width="384"></p>
<p><br></p>
<div class="section level4">
<h4 id="ses-fun-arg">Passing arguments to <code>FUN</code><a class="anchor" aria-label="anchor" href="#ses-fun-arg"></a>
</h4>
<p>It is also possible to send arguments to the function that calculates
the desired metric (<code>FUN</code>). It can be done by sending a list
of arguments through <code>FUN_args</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## let's create some missing values for layer/species 1</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">r</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cellsNA</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/sample.html" class="external-link">spatSample</a></span><span class="op">(</span><span class="va">r2</span>, <span class="fl">30</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, cells <span class="op">=</span> <span class="cn">TRUE</span>, values <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">r2</span><span class="op">[</span><span class="va">cellsNA</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="co"># plot(r)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">sesNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SESraster.html">SESraster</a></span><span class="op">(</span><span class="va">r2</span>, FUN <span class="op">=</span> <span class="va">appmean</span>, FUN_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                   spat_alg <span class="op">=</span> <span class="st">"bootspat_naive"</span>, spat_alg_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>random <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span>,</span>
<span>                   aleats <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sesNA</span><span class="op">[</span><span class="va">cellsNA</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Observed.mean Null_Mean.mean Null_SD.mean SES.mean</span></span>
<span><span class="co">#&gt; 1            NA             NA           NA       NA</span></span>
<span><span class="co">#&gt; 2            NA             NA           NA       NA</span></span>
<span><span class="co">#&gt; 3            NA             NA           NA       NA</span></span>
<span><span class="co">#&gt; 4            NA             NA           NA       NA</span></span>
<span><span class="co">#&gt; 5            NA             NA           NA       NA</span></span>
<span><span class="co">#&gt; 6            NA             NA           NA       NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sesNA</span><span class="op">)</span></span></code></pre></div>
<p><img src="SES_files/figure-html/ses-spat-na1-1.png" width="384"></p>
<p><br></p>
<p>Notice that NAs can be ignored by the <code>appmean()</code> function
by using <code>FUN_args = list(na.rm = TRUE)</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ses.woNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SESraster.html">SESraster</a></span><span class="op">(</span><span class="va">r2</span>, FUN <span class="op">=</span> <span class="va">appmean</span>, FUN_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                      spat_alg <span class="op">=</span> <span class="st">"bootspat_naive"</span>, spat_alg_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>random <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span>,</span>
<span>                      aleats <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ses.woNA</span><span class="op">[</span><span class="va">cellsNA</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Observed.mean Null_Mean.mean Null_SD.mean   SES.mean</span></span>
<span><span class="co">#&gt; 1    0.11764706      0.3882353   0.08921030 -3.0331502</span></span>
<span><span class="co">#&gt; 2    0.41176471      0.3882353   0.08921030  0.2637522</span></span>
<span><span class="co">#&gt; 3    0.41176471      0.4117647   0.09300817  0.0000000</span></span>
<span><span class="co">#&gt; 4    0.05882353      0.3647059   0.07669650 -3.9882179</span></span>
<span><span class="co">#&gt; 5    0.35294118      0.4000000   0.07669650 -0.6135720</span></span>
<span><span class="co">#&gt; 6    0.52941176      0.4941176   0.08921030  0.3956283</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ses.woNA</span><span class="op">)</span></span></code></pre></div>
<p><img src="SES_files/figure-html/ses-spat-na2-1.png" width="384"></p>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="ses-trait">SES from species trait randomization<a class="anchor" aria-label="anchor" href="#ses-trait"></a>
</h3>
<p>In addition to the spatial randomizations, it is possible to create a
null model by randomizing a parameter (i.e. argument) of the metric
passed to FUN. This is useful, for example, to randomize a species trait
(e.g. branch length) that is used to compute the metric. In the example
below the function <code>appsv()</code> uses the argument
<code>lyrv</code> to compute the fictional metric. We also create some
fictional values for the trait.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## example with `Fa_alg`</span></span>
<span><span class="va">appsv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">lyrv</span>, <span class="va">na.rm</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>                      <span class="va">sumw</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">lyrv</span>, <span class="va">na.rm</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="cn">NA</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">lyrv</span>, na.rm<span class="op">=</span><span class="va">na.rm</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span></span>
<span>                      <span class="op">}</span></span>
<span>                      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sumw</span>, lyrv <span class="op">=</span> <span class="va">lyrv</span>, na.rm<span class="op">=</span><span class="va">na.rm</span>, <span class="va">...</span><span class="op">)</span>, <span class="st">"sumw"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">trait</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">100</span><span class="op">:</span><span class="fl">2000</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trait</span></span>
<span><span class="co">#&gt;  [1]  590 1772 1453  467 1583  538 1707 1561 1546 1634 1846  443 1394  242 1037</span></span>
<span><span class="co">#&gt; [16] 1578 1998 1029</span></span></code></pre></div>
<p><br></p>
<p>In this exapmle, no spatial randomization will be performed, only
trait randomization. To select the <em>trait</em> to be randomized, pick
the desired argument of <code>FUN_args</code> using
<code>Fa_sample</code> and the name of the desired argument (here
“lyrv”). Then select a function, here “sample” is used. It is also
possible to send arguments to the function in <code>Fa_alg</code>
through <code>Fa_alg_args</code>. It works in the same way that
arguments are sent to <code>FUN</code> and <code>spat_alg</code> through
<code>FUN_args</code> and <code>spat_alg_args</code>. <br> In this first
example it is performed a trait sampling <strong>without</strong>
replacement.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ses</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SESraster.html">SESraster</a></span><span class="op">(</span><span class="va">r</span>, FUN <span class="op">=</span> <span class="va">appsv</span>,</span>
<span>                 FUN_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lyrv <span class="op">=</span> <span class="va">trait</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    Fa_sample <span class="op">=</span> <span class="st">"lyrv"</span>,</span>
<span>                    Fa_alg <span class="op">=</span> <span class="st">"sample"</span>, Fa_alg_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                    aleats <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ses</span><span class="op">)</span></span></code></pre></div>
<p><img src="SES_files/figure-html/ses-trait1-1.png" width="384"></p>
<p><br></p>
<p>In this second example it is performed a trait sampling
<strong>with</strong> replacement by passing <code>replace = TRUE</code>
through <code>Fa_alg_args</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ses</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SESraster.html">SESraster</a></span><span class="op">(</span><span class="va">r</span>, FUN <span class="op">=</span> <span class="va">appsv</span>,</span>
<span>                 FUN_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lyrv <span class="op">=</span> <span class="va">trait</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    Fa_sample <span class="op">=</span> <span class="st">"lyrv"</span>,</span>
<span>                    Fa_alg <span class="op">=</span> <span class="st">"sample"</span>, Fa_alg_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    aleats <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ses</span><span class="op">)</span></span></code></pre></div>
<p><img src="SES_files/figure-html/ses-trait2-1.png" width="384"></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="concl">Conclusion<a class="anchor" aria-label="anchor" href="#concl"></a>
</h2>
<p>The <code>SESraster</code> R package aims to simplify the
randomization of raster data and the calculation of standardized effect
sizes for spatial data. We hope it is useful to analize the vast amount
of raster data generated for the analysis of biogeographycal and
macroecological patterns.</p>
<p><br></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-cohen1988" class="csl-entry">
Cohen, Jacob. 1988. <em>Statistical Power Analysis for the Behavioral
Sciences</em>. Academic Press.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Neander Marcel Heming, Flávio M. M. Mota, Gabriela Alves-Ferreira.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
